# üê≥ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è Telegram Hotel

–≠—Ç–æ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Å—Ç–µ–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–∏—Å—ã:
- **app** - PHP 8.3-FPM —Å Laravel
- **nginx** - –í–µ–±-—Å–µ—Ä–≤–µ—Ä Nginx
- **mysql** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL 8.0
- **phpmyadmin** - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
- **node** - Node.js 20 –¥–ª—è frontend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **redis** - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥–∏

### –ü–æ—Ä—Ç—ã:
- **8080** - Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Nginx)
- **8081** - phpMyAdmin
- **5173** - Vite dev server
- **3306** - MySQL
- **6379** - Redis

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd rest-aggregator-miniapp

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Docker:
# DB_HOST=mysql
# DB_DATABASE=telegram_hotel
# DB_USERNAME=laravel_user
# DB_PASSWORD=laravel_password
# REDIS_HOST=redis
# CACHE_STORE=redis
# QUEUE_CONNECTION=redis
```

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)
make setup

# –ò–ª–∏ –ø–æ—à–∞–≥–æ–≤–æ:
make build    # –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
make up       # –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make composer # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make key-generate # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å APP_KEY
make migrate  # –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```

### 3. –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: http://localhost:8080
- **phpMyAdmin**: http://localhost:8081
  - –°–µ—Ä–≤–µ—Ä: `mysql`
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `laravel_user`
  - –ü–∞—Ä–æ–ª—å: `laravel_password`

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
```bash
make up       # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make down     # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make restart  # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make logs     # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make shell    # –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### PHP/Laravel –∫–æ–º–∞–Ω–¥—ã
```bash
make composer              # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make artisan cmd="migrate" # –í—ã–ø–æ–ª–Ω–∏—Ç—å artisan –∫–æ–º–∞–Ω–¥—É
make migrate              # –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-fresh        # –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î
make seed                 # –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏–¥–µ—Ä—ã
make test                 # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make cache-clear          # –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
```

### Frontend –∫–æ–º–∞–Ω–¥—ã
```bash
make npm       # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make npm-build # –°–æ–±—Ä–∞—Ç—å frontend –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
make help        # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
make permissions # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
make clean       # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker —Ñ–∞–π–ª–æ–≤:
```
docker/
‚îú‚îÄ‚îÄ php/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile    # PHP-FPM –æ–±—Ä–∞–∑
‚îÇ   ‚îî‚îÄ‚îÄ local.ini     # PHP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ default.conf  # Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ mysql/
    ‚îî‚îÄ‚îÄ my.cnf        # MySQL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=mysql
DB_DATABASE=telegram_hotel
DB_USERNAME=laravel_user
DB_PASSWORD=laravel_password

# Redis
REDIS_HOST=redis
CACHE_STORE=redis
QUEUE_CONNECTION=redis

# URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
APP_URL=http://localhost:8080
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
make logs           # –í—Å–µ –ª–æ–≥–∏
make logs-app       # –õ–æ–≥–∏ PHP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make logs-nginx     # –õ–æ–≥–∏ Nginx
make logs-mysql     # –õ–æ–≥–∏ MySQL
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º:
```bash
make shell          # Bash –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make shell-mysql    # MySQL –∫–ª–∏–µ–Ω—Ç
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞:
```bash
make permissions    # –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

### PHP –ø–∞–∫–µ—Ç—ã:
```bash
make shell
composer require package-name
```

### Node.js –ø–∞–∫–µ—Ç—ã:
```bash
docker-compose exec node npm install package-name
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
make composer-update  # PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
docker-compose exec node npm update  # Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤:
```bash
make build  # –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
```

## üíæ –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
docker-compose exec mysql mysqldump -u laravel_user -p telegram_hotel > backup.sql
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
docker-compose exec -T mysql mysql -u laravel_user -p telegram_hotel < backup.sql
```

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `make setup` –¥–ª—è –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `make permissions`
3. **–ü–æ—Ä—Ç—ã**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç—ã 8080, 8081, 3306, 5173, 6379 —Å–≤–æ–±–æ–¥–Ω—ã
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ Windows –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WSL2

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `make logs`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: `make restart`
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à: `make cache-clear`
4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—ã: `make build` 