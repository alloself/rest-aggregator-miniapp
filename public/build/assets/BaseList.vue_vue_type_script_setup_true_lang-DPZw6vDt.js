import{s as w,a as h}from"./index-DPm8dB91.js";import{b as $}from"./index-scBVuG3i.js";import{$ as C,l as d}from"./vue-router-B2AH15Lj.js";import{d as B,I as P,r as j,a3 as k,M as A,b as m,e as p,w as y,f as V,g as K,F as N,q as O,m as q,h as z}from"./runtime-dom.esm-bundler-zEsCHIXO.js";const D=e=>e.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`),E=e=>e.toLowerCase().replace(/([-_][a-z])/g,s=>s.slice(1).toUpperCase());function b(e){return e==="true"?!0:e==="false"?!1:!isNaN(Number(e))&&e.trim()!==""?Number(e):e}function I(e){return e.split(/[[\]]/g).filter(Boolean).map((s,o)=>{const t=E(s);return o>0&&/^\d+$/.test(t)?parseInt(t,10):t})}function L(e,s,o){let t=e;for(let i=0;i<s.length-1;i++){const n=s[i],r=s[i+1];t[n]===void 0&&(t[n]=typeof r=="number"?[]:{}),t=t[n]}const a=s[s.length-1];t[a]=o}function M(e){const s={};for(const[o,t]of Object.entries(e)){if(t==null)continue;const a=I(o),i=Array.isArray(t)?t.filter(n=>n!==null).map(b):b(t);L(s,a,i)}return s}function R(e){if(!e)return{};const s={},o=(t,a,i="")=>{const n=i?`${i}[${t}]`:D(t);if(Array.isArray(a))a.forEach((r,l)=>{if(typeof r=="object"&&r!==null)for(const[c,f]of Object.entries(r))o(c,f,`${n}[${l}]`);else s[`${n}[${l}]`]=String(r)});else if(a&&typeof a=="object")for(const[r,l]of Object.entries(a))o(r,l,n);else a&&(s[n]=String(a))};for(const[t,a]of Object.entries(e))o(t,a);return s}const _=B({__name:"BaseList",props:{columns:{default:()=>[]},baseUrl:{default:""},client:{type:[Function,Object]},entity:{},relations:{default:()=>[]},showActions:{type:Boolean,default:!0}},setup(e){const s=P({items:[],params:{}}),o=j([]),t=C(),a=async r=>{try{const l={...r,relations:e.relations},c=R(l),{data:f}=await e.client.get(e.baseUrl,{params:c});t.replace({query:c}),s.items=f}catch(l){console.log(l)}};k(async()=>{const r=M(t.currentRoute.value.query);await a(r)}),A(s.params,async r=>{console.log(r),await a(r)},{deep:!0});const i=()=>{t.push({name:`${d.capitalize(e.entity)}Create`})},n=({data:r})=>{t.push({name:`${d.capitalize(e.entity)}Detail`,params:{id:r.id}})};return(r,l)=>{const c=h,f=$,g=w;return p(),m(g,{value:s.items,showGridlines:"",stripedRows:"",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],onRowClick:n,selectionMode:"multiple",selection:o.value,"onUpdate:selection":l[0]||(l[0]=u=>o.value=u),size:"small"},{paginatorend:y(()=>[r.showActions?(p(),m(f,{key:0,type:"button",icon:"pi pi-plus",text:"",onClick:i})):z("",!0)]),default:y(()=>[V(c,{selectionMode:"multiple"}),(p(!0),K(N,null,O(r.columns,u=>q(r.$slots,`column-${u.field}`,{},()=>[(p(),m(c,{key:u.field,field:u.field,header:u.header,class:"cursor-pointer"},null,8,["field","header"]))])),256))]),_:3},8,["value","selection"])}}});export{_};
