import{s as w,a as $,R as C}from"./index-pHbEs9HG.js";import"./dayjs-CIyxUGNa.js";import{a0 as A,l as b,e as B}from"./vue-router-N5pAs94a.js";import"./SmartForm.vue_vue_type_style_index_0_scoped_f0658e56_lang-CgY81Kit.js";import{b as R}from"./index-BAYEzyGP.js";import{d as y,I as P,r as U,a3 as j,M as k,b as m,e as p,w as h,f as L,g as N,F as S,q as V,m as E,h as K,u as d}from"./runtime-dom.esm-bundler-DAH50JVu.js";import"./index-4ZcGI-Oq.js";const O=e=>e.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`),T=e=>e.toLowerCase().replace(/([-_][a-z])/g,s=>s.slice(1).toUpperCase());function _(e){return e==="true"?!0:e==="false"?!1:!isNaN(Number(e))&&e.trim()!==""?Number(e):e}function q(e){return e.split(/[[\]]/g).filter(Boolean).map((s,n)=>{const t=T(s);return n>0&&/^\d+$/.test(t)?parseInt(t,10):t})}function x(e,s,n){let t=e;for(let i=0;i<s.length-1;i++){const o=s[i],r=s[i+1];t[o]===void 0&&(t[o]=typeof r=="number"?[]:{}),t=t[o]}const a=s[s.length-1];t[a]=n}function z(e){const s={};for(const[n,t]of Object.entries(e)){if(t==null)continue;const a=q(n),i=Array.isArray(t)?t.filter(o=>o!==null).map(_):_(t);x(s,a,i)}return s}function D(e){if(!e)return{};const s={},n=(t,a,i="")=>{const o=i?`${i}[${t}]`:O(t);if(Array.isArray(a))a.forEach((r,c)=>{if(typeof r=="object"&&r!==null)for(const[l,f]of Object.entries(r))n(l,f,`${o}[${c}]`);else s[`${o}[${c}]`]=String(r)});else if(a&&typeof a=="object")for(const[r,c]of Object.entries(a))n(r,c,o);else a&&(s[o]=String(a))};for(const[t,a]of Object.entries(e))n(t,a);return s}const I=y({__name:"BaseList",props:{columns:{default:()=>[]},baseUrl:{default:""},client:{type:[Function,Object]},entity:{},relations:{default:()=>[]},showActions:{type:Boolean,default:!0}},setup(e){const s=P({items:[],params:{}}),n=U([]),t=A(),a=async r=>{try{const c={...r,relations:e.relations},l=D(c),{data:f}=await e.client.get(e.baseUrl,{params:l});t.replace({query:l}),s.items=f}catch(c){console.log(c)}};j(async()=>{const r=z(t.currentRoute.value.query);await a(r)}),k(s.params,async r=>{console.log(r),await a(r)},{deep:!0});const i=()=>{t.push({name:`${b.capitalize(e.entity)}Create`})},o=({data:r})=>{t.push({name:`${b.capitalize(e.entity)}Detail`,params:{id:r.id}})};return(r,c)=>{const l=$,f=R,g=w;return p(),m(g,{value:s.items,showGridlines:"",stripedRows:"",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],onRowClick:o,selectionMode:"multiple",selection:n.value,"onUpdate:selection":c[0]||(c[0]=u=>n.value=u),size:"small"},{paginatorend:h(()=>[r.showActions?(p(),m(f,{key:0,type:"button",icon:"pi pi-plus",text:"",onClick:i})):K("",!0)]),default:h(()=>[L(l,{selectionMode:"multiple"}),(p(!0),N(S,null,V(r.columns,u=>E(r.$slots,`column-${u.field}`,{},()=>[(p(),m(l,{key:u.field,field:u.field,header:u.header,class:"cursor-pointer"},null,8,["field","header"]))])),256))]),_:3},8,["value","selection"])}}}),M=y({__name:"RestaurantList",setup(e){const s=[{field:"name",header:"Название"},{field:"slug",header:"Slug"}];return(n,t)=>(p(),m(I,{columns:s,baseUrl:d(C),client:d(B),entity:"restaurant",showActions:!1},null,8,["baseUrl","client"]))}}),X=y({__name:"List",setup(e){return(s,n)=>(p(),m(d(M)))}});export{X as default};
